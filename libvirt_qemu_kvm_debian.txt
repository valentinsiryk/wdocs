=============================
libvirt + QEMU + KVM + Debian
=============================

Check cpu virtualization access::

    egrep -c '(vmx|svm)' /proc/cpuinfo
    sudo kvm-ok


Check Debian source list ``sources.list``::

    deb http://ftp.de.debian.org/debian jessie main non-free
    deb-src http://ftp.de.debian.org/debian jessie main non-free





Install KVM, libvirt
--------------------

::

    apt-get install qemu-kvm libvirt-bin qemu-utils cpu-checker
    # adduser root libvirt
    # adduser lee libvirt

::

    /etc/libvirt/         # configs
    /etc/libvirt/storage/ # storage configs
    /var/lib/libvirt/     # images, snapshots, etc.


Bridge configuration
--------------------

::

    sudo apt-get update
    sudo apt-get dist-upgrade

    # install drivers
    sudo apt-get install firmware-realtek firmware-linux		

    sudo apt-get install bridge-utils

    nano /etc/sysctl.conf
	    net.ipv4.ip_forward=1

    Create bridge::

        sudo brctl addbr br0


Network configuration ``/etc/network/interfaces``::

	auto lo
	iface lo inet loopback

	auto eth1
	iface eth1 inet manual

	auto br0
	iface br0 inet static
		address <host_ip>
		netmask <mask>
		gateway <ip>
		dns-nameservers <ip1> <ip2>
		bridge_ports eth1
		bridge_stp off
		bridge_fd 0
		bridge_maxwait 0
		
		
Restart and check network configuration::

    sudo /etc/init.d/networking restart
    ifconfig


Show bridges::

    brctl show




Virt-manager
------------

Install latest version::

    sudo wget -q -O - http://archive.getdeb.net/getdeb-archive.key | sudo apt-key add -
    sudo sh -c 'echo "deb http://archive.getdeb.net/ubuntu wily-getdeb apps" >> /etc/apt/sources.list.d/getdeb.list'
    sudo apt-get update && sudo apt-get dist-upgrade
    apt-get install virt-manager

    # config file virt-manager
    ~/.gconf/apps/virt-manager/



